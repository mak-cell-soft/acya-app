<h4>{{mat_tab_label_params}}</h4>
<mat-tab-group>
    <!-- Description de l'entreprise -->
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">storefront</mat-icon>
            {{mat_tab_label_enterprise}}
        </ng-template>
        <!-- Informations générales de l'entreprise -->
        <mat-card class="card-details" [formGroup]="enterpriseForm" (onclick)="this.getEnterpriseInfos()">
            <div>
                <h3>{{mat_card_header_enterprise}}</h3>
                <div class="company-logo">
                    <!-- <img src="/src/assets/logo.png" alt="Company Logo"> -->
                </div>
                <div class="half-width-wrapper">
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_name}}</mat-label>
                        <input matInput formControlName="name">
                        <mat-icon matSuffix>spatial-audio-off</mat-icon>
                    </mat-form-field>
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_desc}}</mat-label>
                        <input matInput formControlName="description">
                        <mat-icon matSuffix>description</mat-icon>
                    </mat-form-field>
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_mail}}</mat-label>
                        <input matInput formControlName="email">
                        <mat-icon matSuffix>email</mat-icon>
                    </mat-form-field>
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_fix_phone}}</mat-label>
                        <input matInput formControlName="phone">
                        <mat-icon matSuffix>phone</mat-icon>
                    </mat-form-field>
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_mobile_1}}</mat-label>
                        <input matInput formControlName="mobileOne">
                        <mat-icon matSuffix>phone_android</mat-icon>
                    </mat-form-field>
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_mobile_2}}</mat-label>
                        <input matInput formControlName="mobileTwo">
                        <mat-icon matSuffix>phone_android</mat-icon>
                    </mat-form-field>
                </div>
            </div>
            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="enableForm()">
                        <mat-icon>
                            update
                        </mat-icon>
                        {{update_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

        <!-- Informations détaillées de l'entreprise -->
        <mat-card class="card-details" [formGroup]="enterpriseForm">
            <div>
                <h3>{{mat_card_header_details}}</h3>
                <mat-form-field class="full-width">
                    <mat-label>{{mat_label_input_enterprise_details_mf}}</mat-label>
                    <input matInput formControlName="matriculeFiscal"
                        placeholder={{mat_input_enterprise_details_placeholder_mf}}>
                </mat-form-field>

                <mat-form-field class="full-width">
                    <mat-label>{{mat_label_input_enterprise_details_devise}}</mat-label>
                    <mat-select formControlName="devise"
                        placeholder={{mat_input_enterprise_details_placeholder_devise}}>
                        <mat-option *ngFor="let devise of devisesOptions" [value]="devise.key">
                            {{ devise.value }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

                <div class="half-width-wrapper">
                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_details_resp_name}}</mat-label>
                        <input matInput formControlName="nameResponsable"
                            placeholder={{mat_input_enterprise_details_placeholder_resp_name}}>
                    </mat-form-field>

                    <mat-form-field class="half-width">
                        <mat-label>{{mat_label_input_enterprise_details_resp_surname}}</mat-label>
                        <input matInput formControlName="surnameResponsable"
                            placeholder={{mat_input_enterprise_details_placeholder_resp_surname}}>
                    </mat-form-field>
                </div>

                <mat-form-field class="full-width">
                    <mat-label>{{mat_label_input_enterprise_details_position}}</mat-label>

                    <mat-select formControlName="positionResponsable"
                        placeholder={{mat_input_enterprise_details_placeholder_position}}>
                        <mat-option *ngFor="let job of jobDescOptions" [value]="job.key">
                            {{ job.value }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="full-width">
                    <mat-label>{{mat_label_input_enterprise_details_address}}</mat-label>
                    <input matInput formControlName="siegeAddress"
                        placeholder={{mat_input_enterprise_details_placeholder_address}}>
                    <mat-icon matSuffix>check</mat-icon>
                </mat-form-field>

                <mat-form-field class="full-width">
                    <mat-label>Registre de Commerce</mat-label>
                    <input matInput formControlName="commercialRegister" placeholder="Registre de Commerce">
                    <mat-icon matSuffix>check</mat-icon>
                </mat-form-field>

                <mat-form-field class="full-width">
                    <mat-label>Au Capital de </mat-label>
                    <input matInput formControlName="capital" placeholder="Exemple : 50 0000,000">
                    <mat-icon matSuffix>check</mat-icon>
                </mat-form-field>

            </div>
            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary">
                        <mat-icon>
                            update
                        </mat-icon>
                        {{update_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

        <!-- Sites de l'entreprise -->
        <mat-card class="card-details">
            <h4>{{mat_card_header_enter_sites}}</h4>
            <table mat-table [dataSource]="allSites" class="mat-elevation-z8 mt-3" *ngIf="allSites.data.length">
                <ng-container matColumnDef="number">
                    <th mat-header-cell *matHeaderCellDef> Numéro </th>
                    <td mat-cell *matCellDef="let element; let i=index">{{ i + 1 }}</td>
                </ng-container>

                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef> Adresse </th>
                    <td mat-cell *matCellDef="let element">{{element.address}}</td>
                </ng-container>

                <ng-container matColumnDef="_gov">
                    <th mat-header-cell *matHeaderCellDef> Gouvernorat </th>
                    <td mat-cell *matCellDef="let element">{{element.gov}}</td>
                </ng-container>

                <ng-container matColumnDef="isForsale">
                    <th mat-header-cell *matHeaderCellDef> Est un point de Vente </th>
                    <td mat-cell *matCellDef="let element">
                        <!-- Bind the slide toggle to the 'isForsale' FormControl for each row -->
                        <mat-slide-toggle [checked]="element.isForsale"
                            (change)="onToggleChange($event, element)"></mat-slide-toggle>
                    </td>
                </ng-container>

                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> Action </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let element; let i = index">
                        <mat-icon *ngIf="!isSiteEdit" class="green-icon" (click)="editSite(element)">edit</mat-icon>
                        <mat-icon *ngIf="isSiteEdit" class="blue-icon" (click)="saveSite(element)">save</mat-icon>
                        <mat-icon *ngIf="isSiteEdit" class="red-icon"
                            (click)="cancelEditSite(element)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="deleteSite(i)">delete</mat-icon>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedSitesColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedSitesColumns;"></tr>
            </table>
            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddSalesSiteDialog()">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>
    </mat-tab>

    <!-- Configuration  -->
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">settings</mat-icon>
            {{mat_tab_label_settings}}
        </ng-template>

        <!--Catégories-->
        <mat-card class="card-details">
            <h5>{{mat_card_settings_config}}</h5>

            <!-- Categories Table -->
            <table mat-table [dataSource]="allCategories" class="mat-elevation-z8" *ngIf="allCategories.data.length">
                <ng-container matColumnDef="reference">
                    <th mat-header-cell *matHeaderCellDef>{{mat_header_cell_ref}}</th>
                    <td mat-cell *matCellDef="let category">
                        <ng-container *ngIf="!category.editing">
                            {{category.reference}}
                        </ng-container>
                        <ng-container *ngIf="category.editing">
                            <input matInput [(ngModel)]="category.reference">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="description">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_desc}} </th>
                    <td mat-cell *matCellDef="let category">
                        <ng-container *ngIf="!category.editing">
                            {{category.description}}
                        </ng-container>
                        <ng-container *ngIf="category.editing">
                            <input matInput [(ngModel)]="category.description">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>{{mat_header_cell_actions}}</th>
                    <td mat-cell *matCellDef="let category">
                        <mat-icon *ngIf="!category.editing" class="green-icon"
                            (click)="editCategory(category)">edit</mat-icon>
                        <mat-icon *ngIf="category.editing" class="blue-icon"
                            (click)="saveCategory(category)">save</mat-icon>
                        <mat-icon *ngIf="category.editing" class="red-icon"
                            (click)="cancelEditCategory(category)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="onDeleteCategory(category)">delete</mat-icon>
                        <mat-icon class="blue-icon" (click)="addSubCategory(category)">add</mat-icon>

                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedCategoriesColumns"></tr>
                <tr mat-row *matRowDef="let category; columns: displayedCategoriesColumns;"
                    (click)="selectCategory(category)"></tr>
            </table>
            <mat-paginator [pageSizeOptions]="[5, 10, 20]"></mat-paginator>

            <!-- Subcategories Table -->
            <table mat-table [dataSource]="selectedCategory.firstchildren || []" class="mat-elevation-z8"
                *ngIf="selectedCategory">
                <ng-container matColumnDef="subReference">
                    <th mat-header-cell *matHeaderCellDef>{{mat_header_cell_ref}}</th>
                    <td mat-cell *matCellDef="let subcategory">
                        <ng-container *ngIf="!subcategory.editing">
                            {{subcategory.reference}}
                        </ng-container>
                        <ng-container *ngIf="subcategory.editing">
                            <input matInput [(ngModel)]="subcategory.reference">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="subDescription">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_desc}} </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let subcategory">
                        <ng-container *ngIf="!subcategory.editing">
                            {{subcategory.description}}
                        </ng-container>
                        <ng-container *ngIf="subcategory.editing">
                            <input matInput [(ngModel)]="subcategory.description">
                        </ng-container>
                    </td>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let subcategory">
                        {{subcategory.description}} </td>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>
                        {{mat_header_cell_actions}}

                    </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let subcategory">
                        <mat-icon *ngIf="!subcategory.editing" class="green-icon"
                            (click)="editSubCategory(subcategory)">edit</mat-icon>
                        <mat-icon *ngIf="subcategory.editing" class="blue-icon"
                            (click)="saveSubCategory(subcategory)">save</mat-icon>
                        <mat-icon *ngIf="subcategory.editing" class="red-icon"
                            (click)="cancelEditSubCategory(subcategory)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="onDeleteSubCategory(subcategory)">delete</mat-icon>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedSubcategoryColumns"></tr>
                <tr mat-row *matRowDef="let subcategory; columns: displayedSubcategoryColumns;"></tr>
            </table>

            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddCategoriesDialog()">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

        <!--Taxes-->
        <mat-card class="card-details">
            <h5>{{mat_card_header_taxe}}</h5>
            <!-- Taxes Table -->
            <table mat-table [dataSource]="appvariablesTaxes" class="mat-elevation-z8 mt-3"
                *ngIf="appvariablesTaxes.length">
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_name}} </th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="!element.editing">
                            {{element.name}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.name">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="value">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_value}} </th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="!element.editing">
                            {{element.value}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.value">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="isactive">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_isactive}} </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [(ngModel)]="element.isactive"></mat-slide-toggle>
                    </td>
                </ng-container>

                <ng-container matColumnDef="isdefault">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_isdefault}} </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [(ngModel)]="element.isdefault"></mat-slide-toggle>
                    </td>
                </ng-container>

                <!-- <ng-container matColumnDef="iseditable">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_iseditable}} </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [(ngModel)]="element.iseditable"></mat-slide-toggle>
                    </td>
                </ng-container> -->

                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_action}} </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                        <mat-icon *ngIf="!element.editing" class="green-icon"
                            (click)="editTaxe(element)">edit</mat-icon>
                        <mat-icon *ngIf="element.editing" class="blue-icon" (click)="saveTaxe(element)">save</mat-icon>
                        <mat-icon *ngIf="element.editing" class="red-icon"
                            (click)="cancelEditTaxe(element)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="deleteTaxe(element)">delete</mat-icon>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedAppVariablesTaxesColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedAppVariablesTaxesColumns;"></tr>
            </table>

            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddAppVarDialog('Taxe')">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

        <!-- TVA -->
        <mat-card class="card-details">
            <h5>{{mat_card_header_tva}}</h5>
            <table mat-table [dataSource]="appvariablesTVA" class="mat-elevation-z8 mt-3"
                *ngIf="appvariablesTVA.length">
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_name}} </th>
                    <!-- <td mat-cell *matCellDef="let element">{{element.name}}</td> -->
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="!element.editing">
                            {{element.name}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.name">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="value">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_value}} </th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="!element.editing">
                            {{element.value}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.value">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="isactive">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_isactive}} </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [(ngModel)]="element.isactive"></mat-slide-toggle>
                    </td>
                </ng-container>

                <ng-container matColumnDef="isdefault">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_taxe_isdefault}} </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [(ngModel)]="element.isdefault"></mat-slide-toggle>
                    </td>
                </ng-container>

                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_action}} </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                        <mat-icon *ngIf="!element.editing" class="green-icon" (click)="editTva(element)">edit</mat-icon>
                        <mat-icon *ngIf="element.editing" class="blue-icon" (click)="saveTva(element)">save</mat-icon>
                        <mat-icon *ngIf="element.editing" class="red-icon"
                            (click)="cancelEditTva(element)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="deleteTva(element)">delete</mat-icon>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedAppVariablesTVAColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedAppVariablesTVAColumns;"></tr>
            </table>

            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddAppVarDialog('Tva')">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>


        <!-- Dimensions -->
        <mat-card class="card-details">
            <h5>{{mat_card_header_dimension}}</h5>
            <div>
                <table mat-table [dataSource]="appvariablesDimension" class="mat-elevation-z8 mt-3"
                    *ngIf="appvariablesDimension.data?.length">
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_dimension_name}} </th>
                        <td mat-cell *matCellDef="let element">
                            <ng-container *ngIf="!element.editing">
                                {{element.name}}
                            </ng-container>
                            <ng-container *ngIf="element.editing">
                                <input matInput [(ngModel)]="element.name">
                            </ng-container>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="value">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_dimension_value}} </th>
                        <td mat-cell *matCellDef="let element">
                            <ng-container *ngIf="!element.editing">
                                {{element.value}}
                            </ng-container>
                            <ng-container *ngIf="element.editing">
                                <input matInput [(ngModel)]="element.value">
                            </ng-container>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="nature">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_dimension_nature}} </th>
                        <td mat-cell *matCellDef="let element">{{element.nature}}</td>
                    </ng-container>

                    <ng-container matColumnDef="isactive">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_dimension_isactive}} </th>
                        <td mat-cell *matCellDef="let element">
                            <mat-slide-toggle [(ngModel)]="element.isactive"></mat-slide-toggle>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="action">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_action}} </th>
                        <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                            <mat-icon *ngIf="!element.editing" class="green-icon"
                                (click)="editDimension(element)">edit</mat-icon>
                            <mat-icon *ngIf="element.editing" class="blue-icon"
                                (click)="saveDimension(element)">save</mat-icon>
                            <mat-icon *ngIf="element.editing" class="red-icon"
                                (click)="cancelEditDimension(element)">cancel</mat-icon>
                            <mat-icon class="red-icon" (click)="deleteDimension(element)">delete</mat-icon>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedAppVariablesDimensionsColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedAppVariablesDimensionsColumns;"></tr>
                </table>
                <mat-paginator #paginatorDimension [pageSizeOptions]="[5, 10, 25, 100]" aria-label=""></mat-paginator>
            </div>

            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddAppVarDialog('Dimension')">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

        <!-- Longueurs -->
        <mat-card class="card-details">
            <h5>{{mat_card_header_length}}</h5>
            <div>
                <table mat-table [dataSource]="appvariablesLength" class="mat-elevation-z8 mt-3"
                    *ngIf="appvariablesLength.data?.length">
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_length_name}} </th>
                        <td mat-cell *matCellDef="let element">
                            <ng-container *ngIf="!element.editing">
                                {{element.name}}
                            </ng-container>
                            <ng-container *ngIf="element.editing">
                                <input matInput [(ngModel)]="element.name">
                            </ng-container>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="value">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_length_value}} </th>
                        <td mat-cell *matCellDef="let element">
                            <ng-container *ngIf="!element.editing">
                                {{element.value}}
                            </ng-container>
                            <ng-container *ngIf="element.editing">
                                <input matInput [(ngModel)]="element.value">
                            </ng-container>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="isactive">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_length_isactive}} </th>
                        <td mat-cell *matCellDef="let element">
                            <mat-slide-toggle [(ngModel)]="element.isactive"></mat-slide-toggle>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="action">
                        <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_action}} </th>
                        <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                            <mat-icon *ngIf="!element.editing" class="green-icon"
                                (click)="editLength(element)">edit</mat-icon>
                            <mat-icon *ngIf="element.editing" class="blue-icon"
                                (click)="saveLength(element)">save</mat-icon>
                            <mat-icon *ngIf="element.editing" class="red-icon"
                                (click)="cancelEditLength(element)">cancel</mat-icon>
                            <mat-icon class="red-icon" (click)="deleteLength(element)">delete</mat-icon>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedAppVariablesLengthColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedAppVariablesLengthColumns;"></tr>
                </table>
                <mat-paginator #paginatorLength [pageSizeOptions]="[5, 10, 25, 100]" aria-label=""></mat-paginator>
            </div>

            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddAppVarDialog('Length')">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

    </mat-tab>

    <!-- Description des Employers et Utilisateurs -->
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">group</mat-icon>
            Employers
        </ng-template>
        <mat-card class="card-details">
            <h5>
                <span matBadge="{{ personsCount }}" matBadgePosition="above after" matBadgeColor="accent"
                    class="user-count-badge">
                    Liste des Employers &nbsp;
                </span>
            </h5>

            <table mat-table [dataSource]="allEmployees.data" class="mat-elevation-z8 mt-3"
                *ngIf="allEmployees.data.length">

                <ng-container matColumnDef="fullname">
                    <th mat-header-cell *matHeaderCellDef> Nom </th>
                    <td mat-cell *matCellDef="let element">{{element.firstname}} {{element.lastname}}</td>
                </ng-container>

                <ng-container matColumnDef="cin">
                    <th mat-header-cell *matHeaderCellDef> Identité Nationale N° </th>
                    <td mat-cell *matCellDef="let element">{{element.cin}}</td>
                </ng-container>

                <ng-container matColumnDef="idcnss">
                    <th mat-header-cell *matHeaderCellDef> Matricule CNSS </th>
                    <td mat-cell *matCellDef="let element">{{element.idcnss}}</td>
                </ng-container>

                <ng-container matColumnDef="role">
                    <th mat-header-cell *matHeaderCellDef> Fonction </th>
                    <td mat-cell *matCellDef="let element">{{ getRoleDescription(element.role) }}</td>
                </ng-container>

                <ng-container matColumnDef="hiredate">
                    <th mat-header-cell *matHeaderCellDef> Début de Contrat </th>
                    <td mat-cell *matCellDef="let element">{{element.hiredate | date: 'dd-MM-yyyy'}}</td>
                </ng-container>

                <ng-container matColumnDef="creationdate">
                    <th mat-header-cell *matHeaderCellDef> Crée le </th>
                    <td mat-cell *matCellDef="let element">{{element.creationdate | date: 'dd-MM-yyyy'}}</td>
                </ng-container>

                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> action </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                        <mat-icon *ngIf="!element.editing" class="green-icon"
                            (click)="editEmployee(element)">edit</mat-icon>
                        <mat-icon *ngIf="element.editing" class="blue-icon"
                            (click)="saveEmployee(element)">save</mat-icon>
                        <mat-icon *ngIf="element.editing" class="red-icon"
                            (click)="cancelEditEmployee(element)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="deleteEmployee(element)">delete</mat-icon>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedEmployeesColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedEmployeesColumns;"></tr>

            </table>
            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddPersonsOrUsersDialog('addPerson')">
                        <mat-icon>
                            add
                        </mat-icon>
                        Ajouter
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>

        <mat-card class="card-details">
            <h5>
                <span matBadge="{{ usersCount }}" matBadgePosition="above after" matBadgeColor="accent"
                    class="user-count-badge">
                    Utilisateurs de l'Application &nbsp;
                </span>
            </h5>

            <table mat-table [dataSource]="allAppUsers.data" class="mat-elevation-z8 mt-3"
                *ngIf="allEmployees.data.length">

                <ng-container matColumnDef="fullname">
                    <th mat-header-cell *matHeaderCellDef> Nom </th>
                    <td mat-cell *matCellDef="let element">{{element.person.firstname}} {{element.person.lastname}}</td>
                </ng-container>

                <ng-container matColumnDef="cin">
                    <th mat-header-cell *matHeaderCellDef> Identité Nationale N° </th>
                    <td mat-cell *matCellDef="let element">{{element.person.cin}}</td>
                </ng-container>

                <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef> Email </th>
                    <td mat-cell *matCellDef="let element">{{element.email}}</td>
                </ng-container>

                <ng-container matColumnDef="login">
                    <th mat-header-cell *matHeaderCellDef> Login </th>
                    <td mat-cell *matCellDef="let element">{{element.login}}</td>
                </ng-container>

                <ng-container matColumnDef="role">
                    <th mat-header-cell *matHeaderCellDef> Fonction </th>
                    <td mat-cell *matCellDef="let element">{{ getRoleDescription(element.person.role) }}</td>
                </ng-container>

                <ng-container matColumnDef="hiredate">
                    <th mat-header-cell *matHeaderCellDef> Début de Contrat </th>
                    <td mat-cell *matCellDef="let element">{{element.person.hiredate | date: 'dd-MM-yyyy'}}</td>
                </ng-container>

                <ng-container matColumnDef="creationdate">
                    <th mat-header-cell *matHeaderCellDef> Crée le </th>
                    <td mat-cell *matCellDef="let element">{{element.person.creationdate | date: 'dd-MM-yyyy'}}</td>
                </ng-container>

                <ng-container matColumnDef="updatedate">
                    <th mat-header-cell *matHeaderCellDef> Modifié le </th>
                    <td mat-cell *matCellDef="let element">{{element.person.updatedate | date: 'dd-MM-yyyy'}}</td>
                </ng-container>

                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> action </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                        <mat-icon *ngIf="!element.editing" class="green-icon"
                            (click)="editAppUser(element)">edit</mat-icon>
                        <mat-icon *ngIf="element.editing" class="blue-icon"
                            (click)="saveAppUser(element)">save</mat-icon>
                        <mat-icon *ngIf="element.editing" class="red-icon"
                            (click)="cancelEditAppUser(element)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="deleteAppUser(element)">delete</mat-icon>
                    </td>
                </ng-container>

                <!-- Permisions -->
                <ng-container matColumnDef="permissions">
                    <th mat-header-cell *matHeaderCellDef> permissions </th>
                    <td mat-cell *matCellDef="let element">

                        <mat-icon style="margin-left: 20px;" class="material-symbols-outlined"
                            (click)="openAddPermisionsDialog(element)">
                            folder_managed
                        </mat-icon>
                    </td>
                </ng-container>

                <!-- Default Site -->
                <ng-container matColumnDef="defaultsite">
                    <th mat-header-cell *matHeaderCellDef><mat-icon
                            style="scale: 1.1; margin-left: 20px;">location_on</mat-icon></th>
                    <td mat-cell *matCellDef="let element">{{ getAddressById(element.defaultsite) }}</td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedAppUsersColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedAppUsersColumns;"></tr>

            </table>
            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddPersonsOrUsersDialog('addAppUser')">
                        <mat-icon>
                            add
                        </mat-icon>
                        Ajouter
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>
    </mat-tab>


    <!-- Bank Account Management-->
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">account_balance</mat-icon>
            {{mat_tab_label_bank_account}}
        </ng-template>
        <mat-card class="card-details">
            <h5>{{mat_card_bank_account_header}}</h5>
            <!-- Bank Accounts Table -->
            <table mat-table [dataSource]="bankAccounts" class="mat-elevation-z8 mt-3" *ngIf="bankAccounts.length">
                <ng-container matColumnDef="reference">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_name}} </th>
                    <td mat-cell *matCellDef="let element">{{element.reference}}</td>
                </ng-container>

                <ng-container matColumnDef="designation">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_description}} </th>
                    <td mat-cell *matCellDef="let element">{{element.designation}}</td>
                </ng-container>

                <ng-container matColumnDef="agency">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_agency}} </th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="!element.editing">
                            {{element.agency}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.agency">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="rib">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_rib}} </th>
                    <td mat-cell *matCellDef="let element"><ng-container *ngIf="!element.editing">
                            {{element.rib}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.rib">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="iban">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_iban}} </th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="!element.editing">
                            {{element.iban}}
                        </ng-container>
                        <ng-container *ngIf="element.editing">
                            <input matInput [(ngModel)]="element.iban">
                        </ng-container>
                    </td>
                </ng-container>

                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> {{mat_header_cell_bank_action}} </th>
                    <td mat-cell style="white-space: pre-line" *matCellDef="let element">
                        <mat-icon *ngIf="!element.editing" class="green-icon"
                            (click)="editBankAccount(element)">edit</mat-icon>
                        <mat-icon *ngIf="element.editing" class="blue-icon"
                            (click)="saveBankAccount(element)">save</mat-icon>
                        <mat-icon *ngIf="element.editing" class="red-icon"
                            (click)="cancelEditBankAccount(element)">cancel</mat-icon>
                        <mat-icon class="red-icon" (click)="deleteBankAccount(element)">delete</mat-icon>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>

            <div class="control-button">
                <mat-dialog-actions>
                    <button mat-flat-button color="primary" (click)="openAddBankDialog()">
                        <mat-icon>
                            add
                        </mat-icon>
                        {{add_button}}
                    </button>
                </mat-dialog-actions>
            </div>
        </mat-card>


    </mat-tab>


</mat-tab-group>